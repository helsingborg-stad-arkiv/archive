<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Website Archive</title>

<!-- Load css / js file from ./assets/dist/manifest.json -->
<script>
  async function loadAssets() {
    const res = await fetch('./assets/dist/manifest.json');
    if (!res.ok) throw new Error('Manifest not found');
    return await res.json();
  }

  async function init() {
    const manifest = await loadAssets();
    const head = document.head;
    for (const [key, value] of Object.entries(manifest)) {

      //Add prefix
      const valueWithPrefix = './assets/dist/' + value;

      // Detect CSS by key or value extension
      if (key.endsWith('.css') || value.endsWith('.css')) {
        head.appendChild(Object.assign(document.createElement('link'), {
          rel: 'stylesheet',
          href: valueWithPrefix
        }));
      } else if (key.endsWith('.js') || value.endsWith('.js')) {
        head.appendChild(Object.assign(document.createElement('script'), {
          src: valueWithPrefix
        }));
      }
    }
  }
  init();
</script>

</head>
<body>

  <!-- Iframe for previewing archived pages -->
  <iframe id="preview" referrerpolicy="no-referrer"></iframe>

  <!-- Initial state message -->
  <div id="initial-state" class="cover-view">
    <h1>Archive Viewer</h1>
    <p>Please use the dropdown menus to select a site and a date to go back in time.</p>
  </div>
  
  <!-- Footer element with navigator -->
  <footer>

    <div id="domain-container" class="field-container">
      <label for="domain" class="field-label">Domain:</label>
      <select id="domain" class="field"></select>
    </div>
    
    <div id="date-container" class="field-container">
      <label for="date" class="field-label">Date:</label>
      <select id="date" class="field"></select>
    </div>
    
    <div id="url-container" class="field-container">
      <label for="url" class="field-label">URL:</label>
      <div id="url" class="field"></div>
    </div>

  </footer>

  <div id="manifest-error" style="display:none;"></div>
</body>
</html>